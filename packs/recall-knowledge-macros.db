{"_id":"6x5pSoA3D9G1N2Pq","name":"Recall Knowledge","type":"script","scope":"global","command":"/**\n * Recall Knowledge Macro\n * This macro should be created in FoundryVTT for players to use\n */\n\nconst controlled = canvas.tokens.controlled;\nif (controlled.length === 0) {\n    ui.notifications.warn(\"Please select your character token first.\");\n    return;\n}\n\nconst targeted = game.user.targets;\nif (targeted.size === 0) {\n    ui.notifications.warn(\"Please target a creature to recall knowledge about.\");\n    return;\n}\n\nconst actor = controlled[0].actor;\nconst target = Array.from(targeted)[0].actor;\n\nif (!actor || !target) {\n    ui.notifications.error(\"Unable to find valid actor and target.\");\n    return;\n}\n\nif (!game.RecallKnowledge?.knowledge) {\n    ui.notifications.error(\"Recall Knowledge module not found or not loaded.\");\n    console.error(\"Recall Knowledge module check failed. Available:\", {\n        \"game.RecallKnowledge\": !!game.RecallKnowledge,\n        \"game.RecallKnowledge.knowledge\": !!game.RecallKnowledge?.knowledge\n    });\n    return;\n}\n\nconst targetActor = Array.from(targeted)[0].actor;\nconst skills = ['arcana', 'nature', 'occultism', 'religion', 'society'];\n\nnew Dialog({\n    title: 'Recall Knowledge',\n    content: `<p>Select a knowledge skill to use against <strong>${Array.from(targeted)[0].name}</strong>:</p>\\n<select id=\"skill-select\">\\n    ${skills.map(s => `<option value=\"${s}\">${s.charAt(0).toUpperCase() + s.slice(1)}</option>`).join('')}\\n</select>`,\n    buttons: {\n        roll: {\n            label: 'Roll',\n            callback: async (html) => {\n                const skill = html.find('#skill-select').val();\n                const result = await game.RecallKnowledge.knowledge.performCheck(actor, skill, { target: targetActor });\n                ui.notifications.info(`Recall Knowledge check completed: ${result.result}`);\n            }\n        },\n        cancel: { label: 'Cancel' }\n    },\n    default: 'roll'\n}).render(true);","img":"icons/svg/book.svg","ownership":{"default":0},"flags":{},"folder":null,"sort":0}
{"_id":"7yZ0LmN4Q5RwS8Tx","name":"View Known Information","type":"script","scope":"global","command":"/**\n * View Known Information Macro\n * This macro displays all information the character has learned about the targeted creature\n */\n\nconst targeted = game.user.targets;\nif (targeted.size === 0) {\n    ui.notifications.warn(\"Please target a creature to view known information.\");\n    return;\n}\n\nconst controlled = canvas.tokens.controlled;\nif (controlled.length === 0) {\n    ui.notifications.warn(\"Please select your character token first.\");\n    return;\n}\n\nconst actor = controlled[0].actor;\n\nif (!game.RecallKnowledge?.knowledge) {\n    ui.notifications.error(\"Recall Knowledge module not found or not loaded.\");\n    return;\n}\n\nconst knownInfo = game.RecallKnowledge.knowledge.getKnownInformation(actor);\n\nif (!knownInfo || knownInfo.length === 0) {\n    ui.notifications.info(\"You haven't learned anything yet.\");\n    return;\n}\n\nconst content = `\\n<div style=\"padding: 8px;\">\\n    <h2 style=\"margin-top: 0;\">Known Information</h2>\\n    <ul style=\"list-style: none; padding-left: 0;\">\\n        ${knownInfo.map(info => `<li style=\"margin-bottom: 8px;\"><strong>${info.label || 'Information'}:</strong> ${info.value || info.description || ''}</li>`).join('')}\\n    </ul>\\n</div>\\n`;\n\nnew Dialog({\n    title: 'Known Information',\n    content: content,\n    buttons: { close: { label: 'Close' } }\n}).render(true);","img":"icons/svg/book.svg","ownership":{"default":0},"flags":{},"folder":null,"sort":100}
